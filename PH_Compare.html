<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Placeholder Validator</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap');
    body {
      font-family: 'Montserrat', sans-serif;
      padding: 20px;
      background-color: white;
      color: black;
      transition: background-color 0.3s, color 0.3s;
    }
    .title {
      text-align: left;
      font-weight: 700;
      margin-bottom: 20px;
      font-size: 24px;
      font-family: 'Montserrat', sans-serif;
    }
    textarea {
      width: 100%;
      height: 200px;
      margin-bottom: 10px;
      font-family: 'Montserrat', sans-serif;
    }
    .textareas {
      display: flex;
      gap: 20px;
    }
    .textareas > div {
      flex: 1;
    }
    #compareBtn {
      width: 100%;
      padding: 12px;
      margin-top: 10px;
      background: #007BFF;
      color: white;
      border: none;
      cursor: pointer;
      border-radius: 4px;
      font-size: 16px;
      font-family: 'Montserrat', sans-serif;
    }
    #compareBtn:hover {
      background: #0056b3;
    }
    table {
      border-collapse: collapse;
      margin: 20px auto 0;
      table-layout: auto;
      width: auto;
      font-family: 'Montserrat', sans-serif;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 6px;
      text-align: left;
    }
    .mismatch {
      background-color: #ffcccc;
    }
    #matchStatus {
      font-size: 24px;
      margin: 20px 0;
      text-align: center;
      font-weight: bold;
      font-family: 'Montserrat', sans-serif;
    }
  </style>
</head>
<body>
  <h3 class="title">Placeholder Validator</h3>
  <div class="textareas">
    <div>
      <h3>Original Build</h3>
      <textarea id="dataInput1" placeholder="Paste original build data here..."></textarea>
    </div>
    <div>
      <h3>Placeholder</h3>
      <textarea id="dataInput2" placeholder="Paste placeholder build data here..."></textarea>
    </div>
  </div>

  <button id="compareBtn" onclick="compareBuilds()">Compare Builds</button>
  <div id="matchStatus"></div>

  <table id="comparisonTable" style="display: none;">
    <thead><tr><th>Attribute</th><th>Original</th><th>Placeholder</th></tr></thead>
    <tbody></tbody>
  </table>

  <script>
    function parseAttributes(data) {
      const attributes = {};
      const extraFields = ['Position','Archetype','Height','Weight','Wingspan'];
      const lines = data.split('\n');
      for (let line of lines) {
        line = line.trim();
        if (!line) continue;
        const parts = line.split(/\t+/);
        let key = parts[0];
        if (key === 'Potential Description') key = 'Archetype';
        const numbers = parts.filter(p => /^\d+$/.test(p));
        if (numbers.length >= 2) {
          attributes[key] = numbers[1];
        } else if (parts.length === 2 && extraFields.includes(key)) {
          attributes[key] = parts[1];
        }
      }
      return attributes;
    }

    function compareBuilds() {
      const data1 = document.getElementById('dataInput1').value;
      const data2 = document.getElementById('dataInput2').value;
      const attr1 = parseAttributes(data1);
      const attr2 = parseAttributes(data2);
      const extraOrder = ['Position','Archetype','Height','Weight','Wingspan'];
      const allFields = Array.from(new Set([...Object.keys(attr1), ...Object.keys(attr2)]));
      const topFields = extraOrder.filter(f => allFields.includes(f));
      const otherFields = allFields.filter(f => !extraOrder.includes(f)).sort();
      const allKeys = [...topFields, ...otherFields];

      const tbody = document.querySelector('#comparisonTable tbody');
      tbody.innerHTML = '';
      let allMatch = true;

      allKeys.forEach(key => {
        const val1 = attr1[key] || '';
        const val2 = attr2[key] || '';
        const row = document.createElement('tr');
        if (val1 !== val2) {
          row.classList.add('mismatch');
          allMatch = false;
        }
        row.innerHTML = `<td>${key}</td><td>${val1}</td><td>${val2}</td>`;
        tbody.appendChild(row);
      });

      document.getElementById('comparisonTable').style.display = 'table';
      const status = document.getElementById('matchStatus');
      status.innerHTML = allMatch
        ? '<span style="color:green; font-weight:bold;">✔ MATCH</span>'
        : '<span style="color:red; font-weight:bold;">✘ NOT MATCHING</span>';
    }
  </script>
</body>
</html>
